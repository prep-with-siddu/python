# 2.4 Sets ‚Äî Notes

> **Status**: ‚úÖ Completed  
> **Date**: 28 February 2026

---

## 1. Creating Sets & Basics

```python
# Literal syntax
fruits = {"apple", "banana", "cherry"}
print(type(fruits))    # <class 'set'>

# ‚ö†Ô∏è Empty set ‚Äî MUST use set(), not {}
empty_set = set()       # ‚úÖ Empty set
empty_dict = {}         # ‚ùå This is an empty DICT, not set!

# From a list (removes duplicates!)
nums = [1, 2, 3, 2, 1, 4, 3]
unique = set(nums)
print(unique)    # {1, 2, 3, 4}  (order not guaranteed!)

# From a string
chars = set("hello")
print(chars)    # {'h', 'e', 'l', 'o'}  (no duplicate 'l')

# Sets are UNORDERED ‚Äî no indexing!
# fruits[0]    # ‚ùå TypeError: 'set' object is not subscriptable

# Sets are MUTABLE ‚Äî can add/remove
fruits.add("mango")
fruits.remove("banana")
print(fruits)    # {'apple', 'cherry', 'mango'}

# Elements must be HASHABLE (immutable)
valid = {1, "hello", (1, 2), True, None, frozenset({3, 4})}
# invalid = {[1, 2]}    # ‚ùå TypeError: unhashable type: 'list'
```

### Set Properties
| Property | Details |
|----------|---------|
| Ordered? | ‚ùå No ‚Äî elements have no index |
| Duplicates? | ‚ùå No ‚Äî automatically removed |
| Mutable? | ‚úÖ Yes ‚Äî add/remove elements |
| Elements | Must be hashable (immutable) |
| Use case | Uniqueness, membership testing, math ops |

### Adding & Removing
```python
s = {1, 2, 3}

# Add
s.add(4)              # {1, 2, 3, 4}
s.add(2)              # {1, 2, 3, 4}  (no duplicate!)

# Update ‚Äî add multiple
s.update([5, 6, 7])   # {1, 2, 3, 4, 5, 6, 7}
s.update({8}, [9])     # Can pass set, list, tuple, etc.

# Remove ‚Äî raises KeyError if missing
s.remove(7)            # ‚úÖ
# s.remove(99)         # ‚ùå KeyError

# Discard ‚Äî NO error if missing (safer!)
s.discard(99)          # ‚úÖ No error
s.discard(6)           # ‚úÖ Removed

# Pop ‚Äî remove and return RANDOM element
elem = s.pop()
print(elem)            # Some element (unpredictable)

# Clear ‚Äî remove all
s.clear()
print(s)               # set()
```

> üí° **Backend rule**: Use `discard()` over `remove()` when you're not sure the element exists.

---

## 2. Set Operations

Sets support mathematical operations like **union**, **intersection**, **difference**, and **symmetric difference**.

```python
a = {1, 2, 3, 4, 5}
b = {4, 5, 6, 7, 8}
```

### Union ‚Äî All unique elements from both
```python
print(a | b)              # {1, 2, 3, 4, 5, 6, 7, 8}
print(a.union(b))         # Same

# Multiple sets
c = {10, 11}
print(a | b | c)          # {1, 2, 3, 4, 5, 6, 7, 8, 10, 11}
print(a.union(b, c))      # Same
```

### Intersection ‚Äî Elements in BOTH
```python
print(a & b)              # {4, 5}
print(a.intersection(b))  # Same

# In-place
a_copy = a.copy()
a_copy &= b               # a_copy is now {4, 5}
a_copy.intersection_update(b)  # Same
```

### Difference ‚Äî In A but NOT in B
```python
print(a - b)              # {1, 2, 3}
print(a.difference(b))    # Same

print(b - a)              # {6, 7, 8}  (order matters!)

# In-place
a_copy = a.copy()
a_copy -= b               # {1, 2, 3}
a_copy.difference_update(b)   # Same
```

### Symmetric Difference ‚Äî In A or B but NOT both
```python
print(a ^ b)                        # {1, 2, 3, 6, 7, 8}
print(a.symmetric_difference(b))    # Same
```

### Visual Summary
```
A = {1, 2, 3, 4, 5}
B = {4, 5, 6, 7, 8}

A | B  (union)                ‚Üí {1, 2, 3, 4, 5, 6, 7, 8}   ALL
A & B  (intersection)         ‚Üí {4, 5}                       BOTH
A - B  (difference)           ‚Üí {1, 2, 3}                    A only
B - A  (difference)           ‚Üí {6, 7, 8}                    B only
A ^ B  (symmetric difference) ‚Üí {1, 2, 3, 6, 7, 8}          NOT both
```

### Subset & Superset
```python
small = {1, 2}
big = {1, 2, 3, 4, 5}

print(small <= big)           # True  (small is subset of big)
print(small.issubset(big))    # True

print(big >= small)           # True  (big is superset of small)
print(big.issuperset(small))  # True

# Proper subset (strictly smaller)
print(small < big)            # True
print(big < big)              # False (not proper ‚Äî equal!)

# Disjoint ‚Äî no common elements
x = {1, 2}
y = {3, 4}
print(x.isdisjoint(y))       # True
```

---

## 3. `frozenset` ‚Äî Immutable Set

```python
# frozenset ‚Äî like set but CANNOT be modified
fs = frozenset([1, 2, 3, 4])
print(fs)    # frozenset({1, 2, 3, 4})

# ‚ùå Cannot modify
# fs.add(5)       # AttributeError
# fs.remove(1)    # AttributeError

# ‚úÖ Can do set operations (returns new frozenset)
fs2 = frozenset([3, 4, 5, 6])
print(fs | fs2)     # frozenset({1, 2, 3, 4, 5, 6})
print(fs & fs2)     # frozenset({3, 4})

# ‚úÖ Can be a dict KEY (because it's hashable!)
permissions = {
    frozenset({"read", "write"}): "editor",
    frozenset({"read"}): "viewer",
    frozenset({"read", "write", "admin"}): "admin",
}
print(permissions[frozenset({"read", "write"})])    # editor

# ‚úÖ Can be a SET element
set_of_sets = {frozenset({1, 2}), frozenset({3, 4})}
```

> üí° Use `frozenset` when you need a set that can be a **dict key** or **element of another set**.

---

## 4. Set Comprehensions

```python
# Syntax: {expr for var in iterable}

# Squares
squares = {x**2 for x in range(6)}
print(squares)    # {0, 1, 4, 9, 16, 25}

# With condition
evens = {x for x in range(20) if x % 2 == 0}
print(evens)    # {0, 2, 4, 6, 8, 10, 12, 14, 16, 18}

# Unique first letters
words = ["apple", "avocado", "banana", "blueberry", "cherry"]
first_letters = {w[0] for w in words}
print(first_letters)    # {'a', 'b', 'c'}

# Unique lengths
lengths = {len(w) for w in words}
print(lengths)    # {5, 6, 7, 9}

# Remove duplicates while transforming
emails = ["Sid@Mail.com", "sid@mail.com", "RAHUL@mail.com", "rahul@mail.com"]
unique_emails = {e.lower() for e in emails}
print(unique_emails)    # {'sid@mail.com', 'rahul@mail.com'}
```

---

## 5. When to Use Sets ‚Äî Real-World Patterns

### Removing Duplicates
```python
# Fastest way to remove duplicates from a list
items = [1, 2, 2, 3, 3, 3, 4, 4, 4, 4]
unique = list(set(items))    # [1, 2, 3, 4]  (order may change!)

# Preserve order while removing duplicates (Python 3.7+)
unique_ordered = list(dict.fromkeys(items))    # [1, 2, 3, 4] (order preserved!)
```

### Fast Membership Testing (`in`)
```python
# set lookup is O(1) ‚Äî MUCH faster than list O(n)!
allowed_ips = {"192.168.1.1", "10.0.0.1", "172.16.0.1"}

def is_allowed(ip):
    return ip in allowed_ips    # O(1) lookup!

print(is_allowed("10.0.0.1"))    # True
print(is_allowed("99.99.99.99")) # False

# Compare:
# list: O(n) ‚Äî checks each element
# set:  O(1) ‚Äî hash-based lookup (same as dict)
```

### Finding Common/Different Elements
```python
# Users who are both buyers AND sellers
buyers = {"Sid", "Rahul", "Priya", "Amit"}
sellers = {"Priya", "Amit", "Sneha", "Raj"}

both = buyers & sellers           # {'Priya', 'Amit'}
only_buyers = buyers - sellers    # {'Sid', 'Rahul'}
only_sellers = sellers - buyers   # {'Sneha', 'Raj'}
either_only = buyers ^ sellers    # {'Sid', 'Rahul', 'Sneha', 'Raj'}
```

### Deduplication in API Responses
```python
# Backend: Collect unique tags from multiple posts
posts = [
    {"title": "Python Tips", "tags": ["python", "tips", "backend"]},
    {"title": "FastAPI Guide", "tags": ["python", "fastapi", "backend"]},
    {"title": "Docker Basics", "tags": ["docker", "devops"]},
]

all_tags = set()
for post in posts:
    all_tags.update(post["tags"])

print(all_tags)    # {'python', 'tips', 'backend', 'fastapi', 'docker', 'devops'}
```

### Performance Comparison
```python
import time

# List vs Set ‚Äî membership testing
big_list = list(range(1_000_000))
big_set = set(range(1_000_000))

# Testing `in` ‚Äî search for last element
start = time.time()
999_999 in big_list     # O(n) ‚Äî scans entire list
list_time = time.time() - start

start = time.time()
999_999 in big_set      # O(1) ‚Äî instant hash lookup
set_time = time.time() - start

print(f"List: {list_time:.6f}s  |  Set: {set_time:.8f}s")
# List: ~0.015s  |  Set: ~0.0000001s  (100,000x faster!)
```

---

## üîó Quick Reference

```python
s = {1, 2, 3}

# Create
set()                    # Empty set
{1, 2, 3}               # Literal
set([1, 2, 2, 3])       # From iterable (deduped)

# Add/Remove
s.add(4)                 # Add one
s.update([5, 6])         # Add multiple
s.discard(99)            # Remove (no error if missing)
s.remove(1)              # Remove (KeyError if missing)
s.pop()                  # Remove random
s.clear()                # Remove all

# Operations
a | b                    # Union
a & b                    # Intersection
a - b                    # Difference
a ^ b                    # Symmetric difference

# Comparisons
a <= b                   # Subset
a >= b                   # Superset
a.isdisjoint(b)          # No common elements?

# Immutable
frozenset([1, 2, 3])    # Can be dict key or set element

# Comprehension
{x**2 for x in range(5)}
```

---

> üìù **Next up**: Section 2.5 ‚Äî Other Data Structures (deque, heapq, array, bisect, enum)
